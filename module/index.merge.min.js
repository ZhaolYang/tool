define("imgScroll",["jquery"],function(t){function i(t){this.$ct=t.ct,this.$wrapper=this.$ct.parent(),this.stepWidth=this.$wrapper.width(),this.$ct.find("li").width(this.stepWidth),this.currentIndex=0,this.$prev=t.prev,this.$next=t.next,this.isAnimationOver=!0,this.originLength=this.$ct.children().length,this.$barsBtn=t.barsBtn,this.init()}return i.prototype={init:function(){var t=this.$ct.children().eq(0),i=this.$ct.children().eq(this.$ct.children().length-1);t.clone().appendTo(this.$ct),i.clone().prependTo(this.$ct),this.$ct.css("margin-left","-"+this.stepWidth+"px"),this.$ct.width(this.$ct.children().length*this.stepWidth),this.bind()},move:function(t){var i=this;this.isAnimationOver&&(this.isAnimationOver=!1,this.$ct.animate({marginLeft:-1*(this.currentIndex+1)*this.stepWidth-t*this.stepWidth+"px"},500,function(){i.currentIndex+=t,i.isAnimationOver=!0,i.isLimited(),i.$barsBtn.removeClass("active").eq(i.currentIndex).addClass("active")}))},bind:function(){var i=this;this.$prev.click(function(t){t.preventDefault(),i.move(-1)}),this.$next.click(function(t){t.preventDefault(),i.move(1)}),this.$barsBtn.click(function(){var n=t(this).attr("data-index");i.move(n-i.currentIndex)})},isLimited:function(){this.currentIndex===-1&&(this.currentIndex=this.originLength-1,this.$ct.css("margin-left",-1*this.originLength*this.stepWidth+"px")),this.currentIndex===this.originLength&&(this.currentIndex=0,this.$ct.css("margin-left",-1*this.stepWidth+"px"))}},i}),define("lazyLoad",["jquery"],function(t){function i(t){this.$dom=t,this.initImg(t),this.init()}return i.prototype={init:function(){var i=this;t(window).on("scroll",function(){i.initImg(i.$dom)})},initImg:function(i){var n=this;i.not(".loaded").each(function(){n.isVisible(t(this))&&(n.showImg(t(this)),t(this).addClass("loaded"))})},isVisible:function(i){var n=t(window).height(),e=t(window).scrollTop(),r=i.outerHeight(),s=i.offset().top;return n+e>s&&e<s+r},showImg:function(t){var i=t.attr("data-src");t.attr("src",i)}},i}),define("waterFull",["jquery"],function(t){function i(t){this.$dom=t,this.domWidth=t.width(),this.heightArr=[],this.cols=Math.round(t.parent().width()/this.domWidth),this.init()}return i.prototype={init:function(){for(var t=0;t<this.cols;t++)this.heightArr[t]=0;this.render()},render:function(){var i=this;this.$dom.each(function(){var n=Math.min.apply(null,i.heightArr),e=i.heightArr.indexOf(n);t(this).css({top:i.heightArr[e],left:e*i.domWidth}),console.log(i.heightArr),i.heightArr[e]+=t(this).height()});var n=Math.max.apply(null,i.heightArr);console.log(n),this.$dom.parent().height(n)}},i}),requirejs.config({baseUrl:"js",paths:{jquery:"http://apps.bdimg.com/libs/jquery/1.11.1/jquery.min"}}),requirejs(["jquery","imgScroll","lazyLoad","waterFull"],function(t,i,n,e){function r(){t.ajax({url:"/getInfo",type:"get",dataType:"json",success:function(i){console.log(i);for(var n=i.data,r=0;r<n.length;r++){var h=document.createElement("li");h.className="img-item",t(h).html('<img src="'+n[r]+'">'),s.append(h)}var o=t(".steps-wrapper").find("img").not(".loaded"),c=o.length;o.load(function(){t(this).addClass("loaded"),c--,c>0||new e(t(".img-item"))})},error:function(){console.log("error")}})}new i({ct:t(".scroll-imgs"),prev:t(".scroll-prevbtn"),next:t(".scroll-nextbtn"),barsBtn:t(".btn-container li")}),new n(t(".sailor-img"));var s=t("#imgCt");r(),t(".get-more").click(function(){r()})}),define("main",function(){});